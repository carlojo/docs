---
title: 'Sobre errores'
description: 'Guia sobre manejo de errores en transfiya para SPI'
icon: 'triangle-exclamation'
---

## Modelo de errores

Transfiya implementa un sistema de manejo de errores basado en mensajes HTTP estándar para asegurar consistencia en sus comunicaciones.

Los sistemas externos como DICE y MOL utilizan códigos de error específicos, sin embargo, Transfiya cuenta con un mecanismo que mapea automáticamente estos códigos a su estructura de errores genérica.

Esta capacidad de estandarización simplifica considerablemente el proceso de integración para los participantes del sistema, reduciendo o incluso eliminando la necesidad de desarrollar lógicas de manejo de errores específicas.


### Mensajes de error

Cuando ocurre un error en una transferencia o directorio, el sistema devuelve códigos de estado HTTP apropiados junto con un objeto de error que contiene información detallada.

Los códigos de error están organizados en rangos específicos para facilitar la categorización y el diagnóstico de los problemas.

Los errores están segmentados según el participante:

- `1xx` - Errores de sistema TransfiYa
- `3xx` - Errores de participantes
- `7xx` - Errores de flujo

Todas las solicitudes exitosas a la nube de minka tienen un estado HTTP `200`.

Si hubo un error al procesar la solicitud, el objeto de error está en la respuesta. El objeto de error contiene el código y la descripción de un error.

```json
{
	"error":
		{
			"code": <error_code>,
			"message": "<error_message>"
		}
}
```

En el caso de transferencias exitosas, un objeto de error con código `0` se añade a la respuesta original.

```jsx
{
	"error":
		{
			"code": 0,
			"message": "Success"
		}
}
```

**Code**

> código de error enviado en el cuerpo de la respuesta de error, esto no es un código de estado HTTP

**Name**

> nombre del error en el código base (nombre de clase). Un nombre vacío significa que este código actualmente no es generado por el código base de minka/v1 que puede provenir de sistemas externos.
>

**Message**

> ejemplo de mensaje de error, algunos errores tienen un mensaje fijo y otros tienen un mensaje dinámico. El mensaje no debe usarse para identificar errores, el código de error debe usarse para este propósito.
>

## Errores SPI (Bre-B)

DICE y MOL están implementando un nuevo sistema de códigos de error que son mapeados automáticamente a los códigos de error estándar de Transfiya por el sistema.

DICE y MOL se basan en el Switch ACI, que es fundamentalmente un bus de mensajes tradicional, no una solución basada en web, y los mensajes están codificados con 3 dígitos alfanuméricos. Por ejemplo U804 o C411.

<Warring>
    Los errores de MOL y DICE se incluyen aquí solo con fines de referencia. El participante no necesita mapear estos errores internamente.
</Warring>

<Note>
    Sistema de DICE y MOL no estan en una version estable y no se garantiza que los errores sean consistentes.
</Note>

### Errores DICE

La mayoría de los errores provenientes de DICE son errores de validación que no deberían ser visibles directamente para los participantes.

TransfiYa ya valida todos los campos y esquemas, por lo que muchos de los errores de DICE no deberían ser posibles.

Sin embargo, los mapeamos aquí para estar preparados en caso de encontrarnos con situaciones imprevistas donde estos errores pudieran ocurrir.


La estrategia general de mapeo es la siguiente:

- Los errores de validación de campos se asignan al error de TransfiYa `118 - ResourceValidationError`
- Los errores relacionados con referencias inválidas, por ejemplo, ID de participante inválido, se asignan al error de TransfiYa `121 - ResourceNotFoundError`
- Todas las reglas de negocio, por ejemplo, el tiempo después del cual se puede volver a utilizar una clave cancelada, se asignan al error de TransfiYa `123 - DomainRuleViolationError`
- Todos los errores técnicos, por ejemplo, problemas relacionados con una configuración inválida, se asignan al error de TransfiYa `136 - ApiError`
- Los errores de seguridad se asignan al error de TransfiYa `100 - ForbiddenError`

<Note>
    Referencia para el mapeo se uso el documento
    Directorio Centralizado DICE
    Documento de Especificaciones Técnicas para la Implantación de BRE-B
    Dirección General de Tecnología
    Versión 2.2.1
    2025-03-07
</Note>

| DICE error code | DICE response status | DICE operations | DICE error message | TransfiYa error code | TransfiYa error name | TransfiYaerror message |
| --- | --- | --- | --- | --- | --- | --- |
| C401 | RJCT | NEWR, AMND | El NIT debe ser de 9 dígitos | 118 | ResourceValidationError | DICE error: The NIT must be 9 digits long. |



| DICE error code | DICE response status | DICE operations | DICE error message | TransfiYa error code | TransfiYa error name | TransfiYa error message |
| --- | --- | --- | --- | --- | --- | --- |
| C401 | RJCT | NEWR, AMND | El NIT debe ser de 9 dígitos | 118 | ResourceValidationError | DICE error: The NIT must be 9 digits long. |
| C402 | RJCT | NEWR, AMND | El número de medio de pago excede 34 dígitos | 118 | ResourceValidationError | DICE error: The payment method number exceeds 34 digits  |
| C403 | RJCT | NEWR, AMND | El tipo de medio de pago debe ser uno de los registrados en el diccionario global | 118 | ResourceValidationError | DICE error: The payment method type must be one of those registered in the global dictionary. |
| C404 | RJCT | NEWR, AMND | La EASPBV Receptor debe ser una de las registradas en el diccionario global | 121 | ResourceNotFoundError | DICE error: The EASPBV Receiver must be one of those registered in the global dictionary. |
| C405 | RJCT | NEWR, AMND | El tipo de documento debe ser uno de los registrados en el diccionario global | 118 | ResourceValidationError | DICE error: The document type must be one of those registered in the global dictionary. |
| C406 | RJCT | NEWR, AMND | El tipo de persona debe ser uno de los registrados en el diccionario global | 118 | ResourceValidationError | DICE error: The person type must be one of those recorded in the global dictionary. |
| C407 | RJCT | NEWR, AMND | Para persona natural se debe diligenciar al menos el primer nombre y apellido. En Dsplnm y Nn debe ir una 'N' | 118 | ResourceValidationError | DICE error: For natural persons, at least the first and last name must be entered. The Dsplnm and Nn must be empty. |
| C408 | RJCT | NEWR, AMND | Para persona jurídica debe ser igual el nombre en el Dsplnm y Nn. Los campos de nombres y apellidos de persona natural deben estar vacíos. | 118 | ResourceValidationError | DICE error: For legal entities, the name in the Dsplnm and Nn must be the same. The first and last names fields for natural persons must be empty. |
| C409 | RJCT | NEWR, AMND | Se excede la longitud para nombre de persona jurídica o natural | 118 | ResourceValidationError | DICE error: The length for the name of a legal or natural person is exceeded. |
| C410 | RJCT | NEWR, AMND | La llave debe cumplir las reglas adicionales | 123 | DomainRuleViolationError | DICE error: The key must comply with additional rules. |
| C411 | RJCT | NEWR, DEAC | La llave ha sido cancelada y no cumple el número mínimo de días para registrarse nuevamente. | 123 | DomainRuleViolationError | DICE error: The key has been canceled and does not meet the minimum number of days to register again. |
| U000 | ACTC | NEWR, AMND | Operación exitosa | 0 | - | Success |
| U101 | RJCT | NEWR, AMND, DEAC, SUSP, SUSB, ACTV, ACTB | Tenant Id no encontrado. Debe ser DICETEST01 | 136 | ApiError | DICE error: Tenant ID not found. Must be DICETEST01. |
| U103 | RJCT | NEWR, AMND, DEAC | El código de la EASPBV no existe | 121 | ResourceNotFoundError | DICE error: The EASPBV code does not exist. |
| U119 | RJCT | NEWR, AMND | Error de sesión (errores de validación) | 136 | ApiError | DICE error: Session error. |
| U122 | RJCT | NEWR, AMND, DEAC, SUSP, SUSB, ACTV, ACTB | Se genera cuando el canal no está abierto211 | 136 | ApiError | DICE error: Channel not open. |
| U212 | RJCT | NEWR, AMND, DEAC, SUSP, SUSB, ACTV, ACTB | Mensaje enviado por un canal que no corresponde | 136 | ApiError | DICE error: Message sent by an inappropriate channel. |
| U250 | RJCT | NEWR, AMND | El tipo de llave debe ser uno de los registrados en el diccionario global | 118 | ResourceValidationError | DICE error: The key type must be one of those registered in the global dictionary. |
| U801 | RJCT | NEWR, AMND | No se puede determinar el participante | 118 | ResourceValidationError | DICE error: The participant cannot be determined. |
| U804 | RJCT | AMND, DEAC, SUSP, SUSB, ACTV, ACTB | La llave no existe o esta Inactiva. | 121 | ResourceNotFoundError | DICE error: The key does not exist or is inactive. |
| U805 | RJCT | AMND, SUSP, SUSB, ACTV, ACTB | La llave está suspendida por el cliente. | 123 | DomainRuleViolationError | DICE error: The key is suspended by the customer. |
| U806 | RJCT | NEWR, SUSP, SUSB, ACTV, ACTB | La llave ya está registrada con la misma entidad financiera, pero cuenta distinta. | 123 | DomainRuleViolationError | DICE error: The key is already registered with the same financial institution, but to a different account. |
| U807 | RJCT | NEWR | La llave ya está registrada con otra entidad financiera. | 123 | DomainRuleViolationError | DICE error: The key is already registered with another financial institution. |
| U808 | RJCT | NEWR | La llave ya se encuentra registrada con la misma cuenta. | 123 | DomainRuleViolationError | DICE error: The key is already registered with the same account. |
| U809 | RJCT | AMND, DEAC, SUSP, SUSB, ACTV, ACTB | No se tiene suficientes privilegios para hacer esta operación. | 100 | ForbiddenError | DICE error: You do not have sufficient privileges to perform this operation. |
| U811 | RJCT | AMND, DEAC, SUSP, SUSB, ACTV | La llave está suspendida por el participante. | 123 | DomainRuleViolationError | DICE error: The key is suspended by the participant. |

### Errores MOL

## MOL

La documentación de MOL define muy pocos errores.

La mayoría son errores de configuración, por lo que no deberían ser visibles para los participantes. El error más común que podría observarse es `U122 - InboundBankNotActive`, el cual ocurre cuando los participantes están fuera de servicio o han sido marcados como suspendidos por cualquier otra razón.

Las validaciones de TransfiYa deberían prevenir la aparición de todos los demás errores, ya que validamos todos los campos antes de establecer contacto con MOL.

Este mapeo está basado en el siguiente documento:

<Info>
    Referencia para el mapeo se uso el documento
    Documento Mecanismo Operativo para la Liquidación – MOL
    Documento de Especificaciones Técnicas para la Implantación de BRE-B
    Dirección General de Tecnología
    Versión 2.1.1
    2025-03-07
</Info>

| MOL error code | MOL response status | MOL operation | MOL error name | TransfiYa error code | TransfiYa error name | TransfiYa error message | Description |
| --- | --- | --- | --- | --- | --- | --- | --- |
| U000 | ACTC | Credit transfer | Success | 0 | - | Success |  |
| U119 | RJCT | Credit transfer | SessionValidationFailed | 118 |ResourceValidationError | MOL validation error: MOL message | Validation error related related to message sent to MOL. |
| U112 | RJCT | Credit transfer | MaxAmountCheckFailed | 123 | DomainRuleViolationError | MOL error: The amount exceeds the maximum amount allowed. | Transaction amount is above the maximum allowed amount. |
| U125 | RJCT | Credit transfer | InboundBankClassifierNotFound | 107 | InvalidTargetError | MOL error: Target participant is not configured in the system. | The target participant is not configured in the system. |
| U126 | RJCT | Credit transfer | OutboundBankIdCannotBeDetermined | 103 | InvalidSourceError | MOL error: Source participant is not configured in the system. | This error happens if the source participant is not configured in the system. |
| U122 | RJCT | Credit transfer | InboundBankNotActive | 107 | InvalidTargetError | MOL error: Target participant is not active. | The target participant is configured in the system, but it is inactive. |
| U173 | RJCT | Credit transfer | Validation error | 118 | ResourceValidationError |MOL validation error: MOL message | MOL validations are  not successful on the request. |
| U908 | RJCT | Credit transfer | Rejection lock validation | 136 | ApiError | MOL error: Rejection lock validation MOL message | It is not clear in which case this error happens. |
